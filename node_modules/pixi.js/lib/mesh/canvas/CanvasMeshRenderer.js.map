{"version":3,"sources":["../../../src/mesh/canvas/CanvasMeshRenderer.js"],"names":["core","MeshSpriteRenderer","renderer","render","mesh","context","transform","worldTransform","res","resolution","roundPixels","setTransform","a","b","c","d","tx","ty","setBlendMode","blendMode","drawMode","DRAW_MODES","TRIANGLES","_renderTriangleMesh","_renderTriangles","length","geometry","buffers","data","i","index","_renderDrawTriangle","indices","getIndex","index0","index1","index2","vertices","uvs","texture","_texture","valid","base","baseTexture","textureSource","source","textureWidth","width","textureHeight","height","u0","u1","u2","v0","v1","v2","uploadUvTransform","ut","_uvTransform","mapCoord","x0","x1","x2","y0","y1","y2","canvasPadding","paddingX","paddingY","centerX","centerY","normX","normY","dist","Math","sqrt","save","beginPath","moveTo","lineTo","closePath","clip","delta","deltaA","deltaB","deltaC","deltaD","deltaE","deltaF","drawImage","restore","renderMeshFlat","getAttribute","fillStyle","fill","destroy","CanvasRenderer","registerPlugin"],"mappings":"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","file":"CanvasMeshRenderer.js","sourcesContent":["import * as core from '../../core';\n\n/**\n * Renderer dedicated to meshes.\n *\n * @class\n * @private\n * @memberof PIXI\n */\nexport default class MeshSpriteRenderer\n{\n    /**\n     * @param {PIXI.CanvasRenderer} renderer - The renderer this downport works for\n     */\n    constructor(renderer)\n    {\n        this.renderer = renderer;\n    }\n\n    /**\n     * Renders the Mesh\n     *\n     * @param {PIXI.mesh.Mesh} mesh - the Mesh to render\n     */\n    render(mesh)\n    {\n        const renderer = this.renderer;\n        const context = renderer.context;\n\n        const transform = mesh.worldTransform;\n        const res = renderer.resolution;\n\n        if (renderer.roundPixels)\n        {\n            context.setTransform(\n                transform.a * res,\n                transform.b * res,\n                transform.c * res,\n                transform.d * res,\n                (transform.tx * res) | 0,\n                (transform.ty * res) | 0\n            );\n        }\n        else\n        {\n            context.setTransform(\n                transform.a * res,\n                transform.b * res,\n                transform.c * res,\n                transform.d * res,\n                transform.tx * res,\n                transform.ty * res\n            );\n        }\n\n        renderer.setBlendMode(mesh.blendMode);\n\n        if (mesh.drawMode !== core.DRAW_MODES.TRIANGLES)\n        {\n            this._renderTriangleMesh(mesh);\n        }\n        else\n        {\n            this._renderTriangles(mesh);\n        }\n    }\n\n    /**\n     * Draws the object in Triangle Mesh mode\n     *\n     * @private\n     * @param {PIXI.mesh.RawMesh} mesh - the Mesh to render\n     */\n    _renderTriangleMesh(mesh)\n    {\n        // draw triangles!!\n        const length = mesh.geometry.buffers[0].data.length;\n\n        for (let i = 0; i < length - 2; i++)\n        {\n            // draw some triangles!\n            const index = i * 2;\n\n            this._renderDrawTriangle(mesh, index, (index + 2), (index + 4));\n        }\n    }\n\n    /**\n     * Draws the object in triangle mode using canvas\n     *\n     * @private\n     * @param {PIXI.mesh.RawMesh} mesh - the current mesh\n     */\n    _renderTriangles(mesh)\n    {\n        // draw triangles!!\n        const indices = mesh.geometry.getIndex().data;\n        const length = indices.length;\n\n        for (let i = 0; i < length; i += 3)\n        {\n            // draw some triangles!\n            const index0 = indices[i] * 2;\n            const index1 = indices[i + 1] * 2;\n            const index2 = indices[i + 2] * 2;\n\n            this._renderDrawTriangle(mesh, index0, index1, index2);\n        }\n    }\n\n    /**\n     * Draws one of the triangles that from the Mesh\n     *\n     * @private\n     * @param {PIXI.mesh.RawMesh} mesh - the current mesh\n     * @param {number} index0 - the index of the first vertex\n     * @param {number} index1 - the index of the second vertex\n     * @param {number} index2 - the index of the third vertex\n     */\n    _renderDrawTriangle(mesh, index0, index1, index2)\n    {\n        const context = this.renderer.context;\n        const vertices = mesh.geometry.buffers[0].data;\n        const uvs = mesh.geometry.buffers[1].data;\n        const texture = mesh._texture;\n\n        if (!texture.valid)\n        {\n            return;\n        }\n\n        const base = texture.baseTexture;\n        const textureSource = base.source;\n        const textureWidth = base.width;\n        const textureHeight = base.height;\n\n        let u0;\n        let u1;\n        let u2;\n        let v0;\n        let v1;\n        let v2;\n\n        if (mesh.uploadUvTransform)\n        {\n            const ut = mesh._uvTransform.mapCoord;\n\n            u0 = ((uvs[index0] * ut.a) + (uvs[index0 + 1] * ut.c) + ut.tx) * base.width;\n            u1 = ((uvs[index1] * ut.a) + (uvs[index1 + 1] * ut.c) + ut.tx) * base.width;\n            u2 = ((uvs[index2] * ut.a) + (uvs[index2 + 1] * ut.c) + ut.tx) * base.width;\n            v0 = ((uvs[index0] * ut.b) + (uvs[index0 + 1] * ut.d) + ut.ty) * base.height;\n            v1 = ((uvs[index1] * ut.b) + (uvs[index1 + 1] * ut.d) + ut.ty) * base.height;\n            v2 = ((uvs[index2] * ut.b) + (uvs[index2 + 1] * ut.d) + ut.ty) * base.height;\n        }\n        else\n        {\n            u0 = uvs[index0] * base.width;\n            u1 = uvs[index1] * base.width;\n            u2 = uvs[index2] * base.width;\n            v0 = uvs[index0 + 1] * base.height;\n            v1 = uvs[index1 + 1] * base.height;\n            v2 = uvs[index2 + 1] * base.height;\n        }\n\n        let x0 = vertices[index0];\n        let x1 = vertices[index1];\n        let x2 = vertices[index2];\n        let y0 = vertices[index0 + 1];\n        let y1 = vertices[index1 + 1];\n        let y2 = vertices[index2 + 1];\n\n        if (mesh.canvasPadding > 0)\n        {\n            const paddingX = mesh.canvasPadding / mesh.worldTransform.a;\n            const paddingY = mesh.canvasPadding / mesh.worldTransform.d;\n            const centerX = (x0 + x1 + x2) / 3;\n            const centerY = (y0 + y1 + y2) / 3;\n\n            let normX = x0 - centerX;\n            let normY = y0 - centerY;\n\n            let dist = Math.sqrt((normX * normX) + (normY * normY));\n\n            x0 = centerX + ((normX / dist) * (dist + paddingX));\n            y0 = centerY + ((normY / dist) * (dist + paddingY));\n\n            //\n\n            normX = x1 - centerX;\n            normY = y1 - centerY;\n\n            dist = Math.sqrt((normX * normX) + (normY * normY));\n            x1 = centerX + ((normX / dist) * (dist + paddingX));\n            y1 = centerY + ((normY / dist) * (dist + paddingY));\n\n            normX = x2 - centerX;\n            normY = y2 - centerY;\n\n            dist = Math.sqrt((normX * normX) + (normY * normY));\n            x2 = centerX + ((normX / dist) * (dist + paddingX));\n            y2 = centerY + ((normY / dist) * (dist + paddingY));\n        }\n\n        context.save();\n        context.beginPath();\n\n        context.moveTo(x0, y0);\n        context.lineTo(x1, y1);\n        context.lineTo(x2, y2);\n\n        context.closePath();\n\n        context.clip();\n\n        // Compute matrix transform\n        const delta = (u0 * v1) + (v0 * u2) + (u1 * v2) - (v1 * u2) - (v0 * u1) - (u0 * v2);\n        const deltaA = (x0 * v1) + (v0 * x2) + (x1 * v2) - (v1 * x2) - (v0 * x1) - (x0 * v2);\n        const deltaB = (u0 * x1) + (x0 * u2) + (u1 * x2) - (x1 * u2) - (x0 * u1) - (u0 * x2);\n        const deltaC = (u0 * v1 * x2) + (v0 * x1 * u2) + (x0 * u1 * v2) - (x0 * v1 * u2) - (v0 * u1 * x2) - (u0 * x1 * v2);\n        const deltaD = (y0 * v1) + (v0 * y2) + (y1 * v2) - (v1 * y2) - (v0 * y1) - (y0 * v2);\n        const deltaE = (u0 * y1) + (y0 * u2) + (u1 * y2) - (y1 * u2) - (y0 * u1) - (u0 * y2);\n        const deltaF = (u0 * v1 * y2) + (v0 * y1 * u2) + (y0 * u1 * v2) - (y0 * v1 * u2) - (v0 * u1 * y2) - (u0 * y1 * v2);\n\n        context.transform(\n            deltaA / delta,\n            deltaD / delta,\n            deltaB / delta,\n            deltaE / delta,\n            deltaC / delta,\n            deltaF / delta\n        );\n\n        context.drawImage(\n            textureSource,\n            0,\n            0,\n            textureWidth * base.resolution,\n            textureHeight * base.resolution,\n            0,\n            0,\n            textureWidth,\n            textureHeight\n        );\n\n        context.restore();\n    }\n\n    /**\n     * Renders a flat Mesh\n     *\n     * @private\n     * @param {PIXI.mesh.RawMesh} mesh - The Mesh to render\n     */\n    renderMeshFlat(mesh)\n    {\n        const context = this.renderer.context;\n        const vertices = mesh.geometry.getAttribute('aVertexPosition').data;\n        const length = vertices.length / 2;\n\n        // this.count++;\n\n        context.beginPath();\n\n        for (let i = 1; i < length - 2; ++i)\n        {\n            // draw some triangles!\n            const index = i * 2;\n\n            const x0 = vertices[index];\n            const y0 = vertices[index + 1];\n\n            const x1 = vertices[index + 2];\n            const y1 = vertices[index + 3];\n\n            const x2 = vertices[index + 4];\n            const y2 = vertices[index + 5];\n\n            context.moveTo(x0, y0);\n            context.lineTo(x1, y1);\n            context.lineTo(x2, y2);\n        }\n\n        context.fillStyle = '#FF0000';\n        context.fill();\n        context.closePath();\n    }\n\n    /**\n     * destroy the the renderer.\n     *\n     */\n    destroy()\n    {\n        this.renderer = null;\n    }\n}\n\ncore.CanvasRenderer.registerPlugin('mesh', MeshSpriteRenderer);\n"]}